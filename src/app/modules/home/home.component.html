<div class="min-h-screen bg-[#111416] text-slate-100">
  <div class="max-w-6xl mx-auto px-4 py-6 space-y-6">

    <!-- FILTROS SUPERIORES -->
    <div class="flex flex-wrap items-center gap-2">
      <button (click)="onSelectGoal('STRENGTH')" [ngClass]="goalFilter === 'STRENGTH'
          ? 'bg-teal-400 text-slate-950 shadow-md'
          : 'bg-[#0f1214] text-slate-200 border border-slate-700 hover:border-teal-300/70'"
        class="px-3 py-1.5 rounded-full text-xs md:text-sm font-medium transition">
        Fuerza
      </button>

      <button (click)="onSelectGoal('HYPERTROPHY')" [ngClass]="goalFilter === 'HYPERTROPHY'
          ? 'bg-teal-400 text-slate-950 shadow-md'
          : 'bg-[#0f1214] text-slate-200 border border-slate-700 hover:border-teal-300/70'"
        class="px-3 py-1.5 rounded-full text-xs md:text-sm font-medium transition">
        Hipertrofia
      </button>

      <button (click)="onSelectGoal('ENDURANCE')" [ngClass]="goalFilter === 'ENDURANCE'
          ? 'bg-teal-400 text-slate-950 shadow-md'
          : 'bg-[#0f1214] text-slate-200 border border-slate-700 hover:border-teal-300/70'"
        class="px-3 py-1.5 rounded-full text-xs md:text-sm font-medium transition">
        Resistencia
      </button>

      <button (click)="onSelectGoal(null)" [ngClass]="goalFilter === null
          ? 'bg-slate-100 text-slate-900 shadow-md'
          : 'bg-transparent text-slate-300 border border-slate-600 hover:border-slate-300'"
        class="px-3 py-1.5 rounded-full text-xs md:text-sm font-medium transition">
        Todos
      </button>
    </div>

    <!-- ORDENAR -->
    <div class="flex flex-wrap items-center justify-between gap-2 text-xs md:text-sm">
      <span class="text-slate-300">Ordenar por:</span>

      <select (change)="onSortChange($any($event.target).value)"
        class="bg-[#0f1214] border border-slate-700 rounded-lg px-3 py-1.5 text-xs md:text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-teal-400/60 focus:border-teal-300">
        <option value="id,desc">Recientes</option>
        <option value="name,asc">Nombre A-Z</option>
        <option value="name,desc">Nombre Z-A</option>
      </select>
    </div>

    <!-- ESTADO: CARGANDO -->
    <div *ngIf="loading" class="flex items-center gap-2 text-sm text-slate-300">
      <span class="w-4 h-4 border-2 border-teal-400 border-t-transparent rounded-full animate-spin"></span>
      Cargando rutinas...
    </div>

    <!-- ESTADO: ERROR -->
    <div *ngIf="errorMsg" class="text-sm text-rose-300 bg-rose-900/40 border border-rose-700/50 rounded-lg px-4 py-3">
      {{ errorMsg }}
    </div>

    <!-- LISTA DE RUTINAS -->
    <div *ngIf="!loading && !errorMsg">
      <div class="flex flex-col gap-4 md:gap-5">

        <div *ngFor="let c of cardsList; trackBy: trackByCard" class="bg-[#171a1d] border border-slate-800 rounded-xl px-4 py-3 md:px-5 md:py-4
                 shadow-[0_10px_25px_rgba(0,0,0,0.45)]
                 hover:border-teal-400/60 hover:shadow-[0_16px_35px_rgba(45,212,191,0.25)]
                 transition flex flex-col gap-3 md:flex-row md:items-center">
          <!-- Icono + info -->
          <div class="flex gap-3 md:flex-1">
            <!-- Icono -->
            <div class="flex-shrink-0 flex items-start justify-center">
              <img class="w-12 h-12 rounded-lg object-cover bg-slate-900 border border-slate-700"
                [src]="c.img ? backendBaseUrl + c.img : 'assets/icons/weight.svg'" alt="Rutina" />
            </div>

            <!-- Texto -->
            <div class="flex-1 flex flex-col gap-1">
              <h3 class="text-sm md:text-base font-semibold text-slate-50">
                {{ c.name }}
              </h3>
              <p class="text-xs md:text-sm text-slate-400 line-clamp-2">
                {{ c.description }}
              </p>

              <!-- Badges -->
              <div class="flex flex-wrap gap-2 mt-1">
                <span
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-[11px] font-semibold uppercase tracking-wide"
                  [ngClass]="{
                    'bg-emerald-500/20 text-emerald-300 border border-emerald-400/50': c.accessType === 'FREE',
                    'bg-indigo-500/20 text-indigo-300 border border-indigo-400/50': c.accessType === 'XP_UNLOCK',
                    'bg-slate-500/20 text-slate-200 border border-slate-400/50': c.accessType !== 'FREE' && c.accessType !== 'XP_UNLOCK'
                  }">
                  {{ c.accessType === 'FREE' ? 'Gratis' : (c.accessType === 'XP_UNLOCK' ? 'XP Unlock' : c.accessType) }}
                </span>

                <span
                  class="inline-flex items-center px-2.5 py-0.5 rounded-full text-[11px] font-medium bg-slate-800/80 text-slate-200 border border-slate-600/80">
                  {{ c.goal | titlecase }}
                </span>
              </div>
            </div>
          </div>

          <!-- Botón -->
          <div class="md:flex-shrink-0 md:ml-4">
            <button (click)="onDetails(c)" class="w-full md:w-auto px-4 py-2 rounded-lg bg-teal-400 text-slate-950 text-xs md:text-sm font-semibold
                     shadow-[0_6px_18px_rgba(45,212,191,0.35)]
                     hover:brightness-110 active:translate-y-[1px] transition">
              Ver detalles
            </button>
          </div>
        </div>

      </div>
    </div>

    <!-- PAGINACIÓN -->
    <div class="flex items-center justify-center gap-4 text-xs md:text-sm text-slate-300 mt-4" *ngIf="totalPages > 1">
      <button (click)="onPageChange(page - 1)" [disabled]="page === 0" class="px-3 py-1.5 rounded-lg border border-slate-600 bg-[#101214]
               disabled:opacity-40 disabled:cursor-not-allowed hover:border-teal-300/70 transition">
        ← Anterior
      </button>

      <span>Página {{ page + 1 }} de {{ totalPages }}</span>

      <button (click)="onPageChange(page + 1)" [disabled]="page + 1 >= totalPages" class="px-3 py-1.5 rounded-lg border border-slate-600 bg-[#101214]
               disabled:opacity-40 disabled:cursor-not-allowed hover:border-teal-300/70 transition">
        Siguiente →
      </button>
    </div>

    <!-- MODAL DETALLE DE RUTINA -->
<div *ngIf="detailOpen"
     class="fixed inset-0 z-40 flex items-end md:items-center justify-center bg-black/70 px-4 pb-4 md:pb-0">

  <!-- Cerrar al dar click en el fondo -->
  <div class="absolute inset-0" (click)="closeDetail()"></div>

  <!-- Contenedor del modal -->
  <div
    class="relative w-full max-w-md bg-[#171a1d] text-slate-100 rounded-t-3xl md:rounded-3xl shadow-2xl p-5 md:p-6
           animate-[slideUp_0.25s_ease-out]">

    <!-- Botón Cerrar (X) -->
    <button
      type="button"
      (click)="closeDetail()"
      class="absolute right-4 top-4 text-slate-400 hover:text-slate-100 transition">
      ✕
    </button>

    <!-- ESTADO: CARGANDO -->
    <div *ngIf="detailLoading" class="space-y-3">
      <div class="h-4 w-40 bg-slate-700/60 rounded animate-pulse"></div>
      <div class="h-3 w-full bg-slate-700/40 rounded animate-pulse"></div>
      <div class="h-3 w-3/4 bg-slate-700/40 rounded animate-pulse"></div>
      <div class="h-9 w-full bg-slate-700/60 rounded-lg mt-4 animate-pulse"></div>
    </div>

    <!-- ESTADO: ERROR -->
    <div *ngIf="!detailLoading && detailError" class="text-sm text-rose-300 bg-rose-900/40 border border-rose-700/60 rounded-lg px-4 py-3">
      {{ detailError }}
    </div>

    <!-- CONTENIDO DEL DETALLE -->
    <ng-container *ngIf="!detailLoading && !detailError && selectedRoutine as r">

      <!-- Título -->
      <h2 class="text-xl md:text-2xl font-bold mb-4">
        {{ r.name }}
      </h2>

      <!-- Descripción -->
      <div class="space-y-3 text-sm md:text-[15px]">
        <div>
          <p class="font-semibold text-slate-200 mb-1">Descripción</p>
          <p class="text-slate-300 leading-relaxed">
            {{ r.description }}
          </p>
        </div>

        <div>
          <p class="font-semibold text-slate-200 mb-1">Objetivo</p>
          <p class="text-slate-300">
            {{ r.goal | titlecase }}
          </p>
        </div>

        <div>
          <p class="font-semibold text-slate-200 mb-1">Nivel sugerido</p>
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold
                       bg-rose-500/15 text-rose-300 border border-rose-400/60">
            {{ r.suggestedLevel || 'Avanzado' }}
          </span>
        </div>
      </div>

      <!-- BOTÓN PRINCIPAL -->
      <div class="mt-5">
        <button
          *ngIf="r.accessType === 'XP_UNLOCK'; else freeBtn"
              (click)="onStartRoutine(r)"
          class="w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-xl
                 bg-slate-900 text-slate-50 font-semibold text-sm
                 border border-slate-600 hover:border-teal-300/70 hover:bg-slate-800
                 transition shadow-[0_10px_25px_rgba(0,0,0,0.6)]">
          <span class="text-amber-300 text-lg">⭐</span>
          Desbloquear con XP
        </button>

        <ng-template #freeBtn>
          <button
              (click)="onStartRoutine(r)"
            class="w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-xl
                   bg-teal-400 text-slate-950 font-semibold text-sm
                   hover:brightness-110 transition
                   shadow-[0_10px_25px_rgba(45,212,191,0.4)]">
            Empezar rutina
          </button>
        </ng-template>
      </div>

    </ng-container>
  </div>
</div>

  </div>
</div>