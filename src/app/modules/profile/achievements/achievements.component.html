<div class="min-h-screen bg-gradient-to-b from-[#0d0f11] via-[#111318] to-[#0d0f11]">
  
  <!-- Header fijo -->
  <header class="sticky top-0 z-40 bg-[#0d0f11]/95 backdrop-blur-md border-b border-slate-800/40">
    <div class="max-w-lg mx-auto px-4 h-14 flex items-center justify-between">
      <!-- Back button -->
      <button (click)="goBack()" 
              class="w-10 h-10 flex items-center justify-center rounded-full bg-slate-800/50 hover:bg-slate-700/60 transition-colors">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
        </svg>
      </button>
      
      <h1 class="text-lg font-semibold text-white">Hazañas</h1>
      
      <div class="w-10"></div>
    </div>
  </header>

  <!-- Loading State -->
  <div *ngIf="loading" class="flex flex-col items-center justify-center py-20">
    <div class="w-12 h-12 border-4 border-amber-400/30 border-t-amber-400 rounded-full animate-spin"></div>
    <p class="mt-4 text-slate-400 text-sm">Cargando hazañas...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="max-w-lg mx-auto px-4 py-20 text-center">
    <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-rose-500/10 flex items-center justify-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-rose-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z" />
      </svg>
    </div>
    <p class="text-slate-400 mb-4">{{ error }}</p>
    <button (click)="loadData()" 
            class="px-6 py-2 bg-amber-500 hover:bg-amber-400 text-white font-medium rounded-lg transition-colors">
      Reintentar
    </button>
  </div>

  <!-- Content -->
  <div *ngIf="!loading && !error" class="max-w-lg mx-auto px-4 pb-8">
    
    <!-- Stats Card -->
    <div class="mt-4 p-5 rounded-2xl bg-gradient-to-br from-amber-500/10 to-orange-500/5 border border-amber-500/20">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-2xl font-bold text-white">
            {{ unlockedCount }}<span class="text-slate-500">/{{ achievements.length }}</span>
          </h2>
          <p class="text-sm text-slate-400">Hazañas desbloqueadas</p>
        </div>
        <div class="w-20 h-20 rounded-full bg-amber-500/20 flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 text-amber-400" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
          </svg>
        </div>
      </div>
      
      <!-- Progress bar -->
      <div class="mt-4">
        <div class="h-2 w-full bg-slate-700/60 rounded-full overflow-hidden">
          <div class="h-full bg-gradient-to-r from-amber-500 to-orange-400 rounded-full transition-all duration-500"
               [style.width.%]="stats?.progress || 0">
          </div>
        </div>
        <p class="mt-1 text-xs text-slate-500 text-right">{{ stats?.progress || 0 }}% completado</p>
      </div>
    </div>

    <!-- Category Filter -->
    <div class="mt-6 flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
      <button *ngFor="let cat of categories"
              (click)="selectCategory(cat.key)"
              class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all"
              [ngClass]="selectedCategory === cat.key 
                ? 'bg-amber-500 text-white shadow-lg shadow-amber-500/25' 
                : 'bg-slate-800/60 text-slate-400 hover:bg-slate-700/60'">
        {{ cat.label }}
      </button>
    </div>

    <!-- Achievements Grid -->
    <div class="mt-6 grid grid-cols-2 gap-3">
      <button *ngFor="let achievement of filteredAchievements"
              (click)="openModal(achievement)"
              class="p-4 rounded-xl border transition-all text-left"
              [ngClass]="achievement.unlocked 
                ? 'bg-slate-800/60 border-amber-500/30 hover:border-amber-400/50' 
                : 'bg-slate-800/30 border-slate-700/30 opacity-50'">
        
        <!-- Icon -->
        <div class="w-14 h-14 rounded-full flex items-center justify-center mb-3"
             [ngClass]="achievement.unlocked ? 'bg-amber-500/20' : 'bg-slate-700/40'">
          
          <!-- Trophy -->
          <svg *ngIf="achievement.icon === 'trophy'" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7"
               [ngClass]="achievement.unlocked ? 'text-amber-400' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
          </svg>
          
          <!-- Medal -->
          <svg *ngIf="achievement.icon === 'medal'" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7"
               [ngClass]="achievement.unlocked ? 'text-amber-400' : 'text-slate-500'"
               fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M12 12.75a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
          </svg>
          
          <!-- Star -->
          <svg *ngIf="achievement.icon === 'star'" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7"
               [ngClass]="achievement.unlocked ? 'text-yellow-400' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
          </svg>
          
          <!-- Crown -->
          <svg *ngIf="achievement.icon === 'crown'" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7"
               [ngClass]="achievement.unlocked ? 'text-yellow-500' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M5 16L3 5L8.5 10L12 4L15.5 10L21 5L19 16H5ZM19 19C19 19.6 18.6 20 18 20H6C5.4 20 5 19.6 5 19V18H19V19Z"/>
          </svg>
          
          <!-- Fire -->
          <svg *ngIf="achievement.icon === 'fire'" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7"
               [ngClass]="achievement.unlocked ? 'text-orange-500' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 23C16.1421 23 19.5 19.6421 19.5 15.5C19.5 14.6345 19.2697 13.8032 19 13C19 13 18.5 14.5 17 14.5C17 14.5 18.151 11.4621 16 8C14.5 9.5 13.5 10 12 10C12 10 12.5 7.5 11 5C9.5 6.5 8 8.75 8 12C8 12 7 12 6 11C6 11 5 13 5 15.5C5 19.6421 7.85786 23 12 23ZM12 21C10.3431 21 9 19.6569 9 18C9 16.3431 10.3431 15 12 15C13.6569 15 15 16.3431 15 18C15 19.6569 13.6569 21 12 21Z"/>
          </svg>
          
          <!-- Bolt -->
          <svg *ngIf="achievement.icon === 'bolt'" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7"
               [ngClass]="achievement.unlocked ? 'text-teal-400' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z"/>
          </svg>
          
          <!-- Pencil -->
          <svg *ngIf="achievement.icon === 'pencil'" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7"
               [ngClass]="achievement.unlocked ? 'text-violet-400' : 'text-slate-500'"
               fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
          </svg>
          
          <!-- Target -->
          <svg *ngIf="achievement.icon === 'target'" xmlns="http://www.w3.org/2000/svg" class="w-7 h-7"
               [ngClass]="achievement.unlocked ? 'text-emerald-400' : 'text-slate-500'"
               fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
          </svg>
        </div>
        
        <!-- Name -->
        <h3 class="font-semibold text-sm"
            [ngClass]="achievement.unlocked ? 'text-white' : 'text-slate-500'">
          {{ achievement.name }}
        </h3>
        
        <!-- XP Reward -->
        <div *ngIf="achievement.xpReward > 0" 
             class="mt-1 inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-medium"
             [ngClass]="achievement.unlocked 
               ? 'bg-teal-500/20 text-teal-400' 
               : 'bg-slate-700/40 text-slate-500'">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
            <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z"/>
          </svg>
          +{{ achievement.xpReward }} XP
        </div>
        
        <!-- Unlocked date -->
        <p *ngIf="achievement.unlocked && achievement.unlockedAt" 
           class="mt-2 text-[10px] text-slate-500">
          {{ formatDate(achievement.unlockedAt) }}
        </p>
      </button>
    </div>

    <!-- Empty state -->
    <div *ngIf="filteredAchievements.length === 0" 
         class="mt-10 text-center py-10">
      <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-slate-800/60 flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-slate-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z" />
        </svg>
      </div>
      <p class="text-slate-500">No hay hazañas en esta categoría</p>
    </div>
  </div>

  <!-- Modal de detalle -->
  <div *ngIf="modalOpen && selectedAchievement" 
       class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm"
       (click)="closeModal()">
    
    <div class="w-full max-w-sm bg-gradient-to-b from-slate-800 to-slate-900 rounded-2xl border border-slate-700/50 shadow-2xl overflow-hidden"
         (click)="$event.stopPropagation()">
      
      <!-- Header con icono grande -->
      <div class="relative pt-10 pb-6 text-center"
           [ngClass]="selectedAchievement.unlocked 
             ? 'bg-gradient-to-b from-amber-500/20 to-transparent' 
             : 'bg-gradient-to-b from-slate-700/30 to-transparent'">
        
        <!-- Glow effect -->
        <div *ngIf="selectedAchievement.unlocked"
             class="absolute top-0 left-1/2 -translate-x-1/2 w-32 h-32 bg-amber-500/30 rounded-full blur-3xl"></div>
        
        <!-- Icon -->
        <div class="relative w-24 h-24 mx-auto rounded-full flex items-center justify-center"
             [ngClass]="selectedAchievement.unlocked ? 'bg-amber-500/20' : 'bg-slate-700/40'">
          
          <!-- Trophy -->
          <svg *ngIf="selectedAchievement.icon === 'trophy'" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12"
               [ngClass]="selectedAchievement.unlocked ? 'text-amber-400' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
          </svg>
          
          <!-- Medal -->
          <svg *ngIf="selectedAchievement.icon === 'medal'" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12"
               [ngClass]="selectedAchievement.unlocked ? 'text-amber-400' : 'text-slate-500'"
               fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M12 12.75a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
          </svg>
          
          <!-- Star -->
          <svg *ngIf="selectedAchievement.icon === 'star'" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12"
               [ngClass]="selectedAchievement.unlocked ? 'text-yellow-400' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
          </svg>
          
          <!-- Crown -->
          <svg *ngIf="selectedAchievement.icon === 'crown'" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12"
               [ngClass]="selectedAchievement.unlocked ? 'text-yellow-500' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M5 16L3 5L8.5 10L12 4L15.5 10L21 5L19 16H5ZM19 19C19 19.6 18.6 20 18 20H6C5.4 20 5 19.6 5 19V18H19V19Z"/>
          </svg>
          
          <!-- Fire -->
          <svg *ngIf="selectedAchievement.icon === 'fire'" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12"
               [ngClass]="selectedAchievement.unlocked ? 'text-orange-500' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 23C16.1421 23 19.5 19.6421 19.5 15.5C19.5 14.6345 19.2697 13.8032 19 13C19 13 18.5 14.5 17 14.5C17 14.5 18.151 11.4621 16 8C14.5 9.5 13.5 10 12 10C12 10 12.5 7.5 11 5C9.5 6.5 8 8.75 8 12C8 12 7 12 6 11C6 11 5 13 5 15.5C5 19.6421 7.85786 23 12 23ZM12 21C10.3431 21 9 19.6569 9 18C9 16.3431 10.3431 15 12 15C13.6569 15 15 16.3431 15 18C15 19.6569 13.6569 21 12 21Z"/>
          </svg>
          
          <!-- Bolt -->
          <svg *ngIf="selectedAchievement.icon === 'bolt'" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12"
               [ngClass]="selectedAchievement.unlocked ? 'text-teal-400' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z"/>
          </svg>
          
          <!-- Pencil -->
          <svg *ngIf="selectedAchievement.icon === 'pencil'" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12"
               [ngClass]="selectedAchievement.unlocked ? 'text-violet-400' : 'text-slate-500'"
               fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
          </svg>
          
          <!-- Target -->
          <svg *ngIf="selectedAchievement.icon === 'target'" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12"
               [ngClass]="selectedAchievement.unlocked ? 'text-emerald-400' : 'text-slate-500'"
               fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
          </svg>
        </div>
        
        <!-- Unlocked badge -->
        <div *ngIf="selectedAchievement.unlocked"
             class="absolute top-4 right-4 px-2 py-1 rounded-full bg-emerald-500/20 border border-emerald-500/30">
          <span class="text-xs font-semibold text-emerald-400">✓ Desbloqueada</span>
        </div>
      </div>
      
      <!-- Content -->
      <div class="px-6 pb-6 text-center">
        <!-- Category badge -->
        <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border"
              [ngClass]="getCategoryColor(selectedAchievement.category)">
          {{ getCategoryLabel(selectedAchievement.category) }}
        </span>
        
        <!-- Name -->
        <h2 class="mt-3 text-xl font-bold text-white">{{ selectedAchievement.name }}</h2>
        
        <!-- Description -->
        <p class="mt-2 text-sm text-slate-400">{{ selectedAchievement.description }}</p>
        
        <!-- XP Reward -->
        <div *ngIf="selectedAchievement.xpReward > 0" 
             class="mt-4 inline-flex items-center gap-2 px-4 py-2 rounded-xl"
             [ngClass]="selectedAchievement.unlocked 
               ? 'bg-teal-500/20 border border-teal-500/30' 
               : 'bg-slate-700/40'">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
               [ngClass]="selectedAchievement.unlocked ? 'text-teal-400' : 'text-slate-500'"
               fill="currentColor" viewBox="0 0 24 24">
            <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z"/>
          </svg>
          <span class="font-bold"
                [ngClass]="selectedAchievement.unlocked ? 'text-teal-400' : 'text-slate-500'">
            +{{ selectedAchievement.xpReward }} XP
          </span>
        </div>
        
        <!-- Unlocked date -->
        <p *ngIf="selectedAchievement.unlocked && selectedAchievement.unlockedAt" 
           class="mt-4 text-xs text-slate-500">
          Desbloqueada el {{ formatDate(selectedAchievement.unlockedAt) }}
        </p>
        
        <!-- Locked message -->
        <p *ngIf="!selectedAchievement.unlocked" 
           class="mt-4 text-xs text-slate-500">
          Aún no has desbloqueado esta hazaña
        </p>
        
        <!-- Close button -->
        <button (click)="closeModal()"
                class="mt-6 w-full py-3 rounded-xl font-semibold transition-all"
                [ngClass]="selectedAchievement.unlocked 
                  ? 'bg-amber-500 hover:bg-amber-400 text-white' 
                  : 'bg-slate-700 hover:bg-slate-600 text-slate-300'">
          Cerrar
        </button>
      </div>
    </div>
  </div>
</div>
